<?go
package cmd

import (
	"fmt"
	"io"
	"maps"

	"deedles.dev/xiter"
)

func (g *GeneratorEcs) generate(wr io.Writer, pkg string) {
?>
// autogenerated code
package <?= pkg ?>

import (
	"slices"

	ecs "github.com/igadmg/goecs"
	"github.com/igadmg/goex/slicesex"
	"github.com/igadmg/raylib-go/raymath/vector2"
)

<?
?>
////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
//// Entities num <?= len(g.entities) ?>
///
<?
	for i, e := range xiter.Enumerate(maps.Values(g.entities)) {
?>
//////////
// <?= e.Name ?>
<?
		g.generateEntity(wr, i+1, e)
	}
?>
////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
//// Components num <?= len(g.components) ?>
///
<?
	for _, e := range xiter.Enumerate(maps.Values(g.components)) {
		g.generateComponent(wr, e)
?>
//////////
// <?= e.Name ?>
<?
	}
?>
////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
//// Queries num <?= len(g.EntitesByQueries) ?>
///
<?
	for q, es := range g.EntitesByQueries {
?>
//////////
// <?= q.Name ?>
<?
		g.generateQuery(wr, q, es)
	}

?>
////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
//// Functions for <?= len(g.Types) ?> types
///
<?
	for _, t := range g.Types {
		g.genFunctions(wr, t)
	}

	g.generateDebug(wr)
}
?>