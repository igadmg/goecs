<?go
package ecs

import (
	"fmt"
	"io"
	"maps"

	"deedles.dev/xiter"
)

func (g *GeneratorEcs) generate(wr io.Writer, pkg string) {
?>
// autogenerated code
package <?= pkg ?>

import (
	"slices"

	"github.com/igadmg/colonization/ecs"
	"github.com/igadmg/goex/slicesex"
)

<?
?>
////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
//// Entities
///
<?
	for i, e := range xiter.Enumerate(maps.Values(g.entities)) {
?>
//////////
// <?= e.Name ?>
<?
		g.generateEntity(wr, i+1, e)
	}
?>
////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
//// Components
///
<?
	for _, e := range xiter.Enumerate(maps.Values(g.components)) {
		g.generateComponent(wr, e)
?>
//////////
// <?= e.Name ?>
<?
	}
?>
////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
//// Entities
///
<?
	for q, es := range g.EntitesByQueries {
?>
//////////
// <?= q.Name ?>
<?
		g.generateQuery(wr, q, es)
	}

	g.generateDebug(wr)
}
?>